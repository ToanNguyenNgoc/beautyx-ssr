{"version":3,"file":"static/js/566.ebb428b3.chunk.js","mappings":"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","sources":["webpack://web-booking/./src/pages/VoucherPage/style.module.css?0da5","pages/VoucherPage/index.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"voucher_page\":\"style_voucher_page__NITQi\",\"voucher_list\":\"style_voucher_list__T4qqB\",\"voucher_item_cnt\":\"style_voucher_item_cnt__p+O+I\",\"voucher_item\":\"style_voucher_item__NDeFh\",\"voucher_item_left\":\"style_voucher_item_left__mgl01\",\"voucher_item_right\":\"style_voucher_item_right__JXzaR\",\"voucher_item_img\":\"style_voucher_item_img__diAC2\",\"voucher_item_expiry\":\"style_voucher_item_expiry__nM2HP\",\"voucher_info_name\":\"style_voucher_info_name__zJOCu\",\"voucher_info_price\":\"style_voucher_info_price__N4nji\",\"voucher_item_btn\":\"style_voucher_item_btn__iEB7o\",\"infinite-scroll-component\":\"style_infinite-scroll-component__ZPNFf\",\"vouvher_loadmore_wrap\":\"style_vouvher_loadmore_wrap__8CgmP\",\"load_item_cnt\":\"style_load_item_cnt__auGQh\",\"load_item_left\":\"style_load_item_left__eYwCT\",\"load_item_right\":\"style_load_item_right__fD8wU\",\"load_item_right_item\":\"style_load_item_right_item__CksjV\",\"voucher_loadmore_btn\":\"style_voucher_loadmore_btn__f0YXy\"};","import React from \"react\";\nimport style from \"./style.module.css\";\nimport { useDeviceMobile, useSwrInfinite } from \"hooks\";\nimport HeadMobile from \"features/HeadMobile\";\nimport { Container } from \"@mui/material\";\nimport { XButton } from \"components/Layout\";\nimport { paramsDiscounts } from \"params-query\";\nimport { EXTRA_FLAT_FORM } from \"api/extraFlatForm\";\nimport { IDiscountPar, IITEMS_DISCOUNT } from \"interface\";\nimport { DISCOUNT_TYPE } from \"../../utils/formatRouterLink/fileType\";\nimport formatPrice from \"utils/formatPrice\";\nimport { useHistory } from \"react-router-dom\";\nimport tracking from \"api/trackApi\";\nimport { analytics, logEvent } from \"../../firebase\";\nimport { formatRouterLinkDiscount } from \"utils/formatRouterLink/formatRouter\";\nimport dayjs from \"dayjs\";\nimport Skeleton from \"react-loading-skeleton\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\n\ninterface DiscountItemsType extends IITEMS_DISCOUNT {\n    discount: IDiscountPar\n}\n\nexport default function VoucherPage() {\n    const IS_MB = useDeviceMobile();\n    const PLAT_FORM = EXTRA_FLAT_FORM();\n    const newParams = {\n        ...paramsDiscounts,\n        limit: 30,\n        sort: PLAT_FORM === \"TIKI\" ? \"-priority\" : \"\",\n    };\n    const { resData, totalItem, onLoadMore } = useSwrInfinite(\n        true,\n        \"/discounts\",\n        newParams\n    );\n    const discounts = resData ?? [];\n    const onViewMore = () => {\n        if (resData.length < totalItem) {\n            onLoadMore()\n        }\n    }\n    const discountItems: DiscountItemsType[] = discounts.map((i: IDiscountPar) => {\n        const items = i.items.map((child: IITEMS_DISCOUNT) => {\n            return {\n                ...child,\n                discount: i\n            }\n        })\n        return items.flat()\n    }).flat()\n\n    return (\n        <div>\n            {IS_MB && <HeadMobile title=\"Voucher\" />}\n            <Container>\n                <div className={style.voucher_page}>\n                    <InfiniteScroll\n                        dataLength={discounts.length}\n                        hasMore={true}\n                        loader={<></>}\n                        next={onViewMore}\n                    >\n                        <div className={style.voucher_list}>\n                            {\n                                discountItems.map((item: DiscountItemsType, index: number) => (\n                                    <ItemDiscount\n                                        item={item}\n                                        key={index}\n                                    />\n                                ))\n                            }\n                        </div>\n                        {resData.length < totalItem && <LoadSkelton />}\n                    </InfiniteScroll>\n                </div>\n            </Container>\n        </div>\n    );\n}\n\nconst ItemDiscount = ({ item }: { item: DiscountItemsType }) => {\n    const history = useHistory();\n    const onDetail = (item: IITEMS_DISCOUNT, discount: IDiscountPar) => {\n        tracking.DISCOOUNT_ITEM_CLICK(\n            item.organization.id,\n            \"khuyến mãi hot\",\n            item.discount_id\n        );\n        logEvent(analytics, \"detail_discount\", {\n            service: item.productable.product_name,\n            merchant: item.organization.name,\n        });\n        history.push(formatRouterLinkDiscount(discount, item));\n    };\n    return (\n        <div className={style.voucher_item_cnt}>\n            <div\n                className={style.voucher_item}\n            >\n                <div\n                    className={\n                        style.voucher_item_left\n                    }\n                >\n                    <div\n                        className={\n                            style.voucher_item_img\n                        }\n                    >\n                        <img\n                            src={\n                                item\n                                    ?.productable\n                                    ?.image\n                                    ? item\n                                        .productable\n                                        ?.image_url\n                                    : item\n                                        .organization\n                                        ?.image_url\n                            }\n                            alt=\"\"\n                        />\n                    </div>\n                </div>\n                <div\n                    className={\n                        style.voucher_item_right\n                    }\n                >\n                    <div\n                        className={\n                            style.voucher_item_info\n                        }\n                    >\n                        <div\n                            className={\n                                style.voucher_info_name\n                            }\n                        >\n                            <span>\n                                {item\n                                    ?.productable\n                                    ?.service_name ||\n                                    item\n                                        ?.productable\n                                        ?.product_name}\n                            </span>\n                        </div>\n                        <div\n                            className={\n                                style.voucher_info_price\n                            }\n                        >\n                            <p>\n                                {formatPrice(\n                                    item\n                                        ?.productable\n                                        ?.price ||\n                                    item\n                                        ?.productable\n                                        ?.retail_price\n                                )}\n                                đ\n                            </p>\n                            <p>\n                                Giảm còn:{\" \"}\n                                <span>\n                                    {item.discount?.discount_type ===\n                                        DISCOUNT_TYPE\n                                            .FINAL_PRICE\n                                            .key\n                                        ? `${formatPrice(\n                                            item.discount?.discount_value\n                                        )}đ`\n                                        : `${formatPrice(\n                                            item?.view_price\n                                        )}đ`}\n                                </span>\n                            </p>\n                        </div>\n                        <div\n                            className={\n                                style.voucher_item_expiry\n                            }\n                        >\n                            <p>\n                                HSD:{\" \"}\n                                {item.discount?.valid_from &&\n                                    dayjs(\n                                        item.discount?.valid_from\n                                    ).format(\n                                        \"DD/MM/YYYY\"\n                                    )}{\" \"}\n                                {\"- \"}\n                                {item.discount?.valid_util &&\n                                    dayjs(\n                                        item.discount?.valid_util\n                                    ).format(\n                                        \"DD/MM/YYYY\"\n                                    )}\n                            </p>\n                        </div>\n                    </div>\n                    <XButton\n                        onClick={()=>onDetail(item, item.discount)}\n                        title={\"Chi tiết\"}\n                        className={`${style.voucher_item_btn}`}\n                    />\n                </div>\n            </div>\n        </div>\n    )\n}\nconst LoadSkelton = () => {\n    const counts = [1, 2, 3, 4, 5, 6, 7, 8];\n    return (\n        <div className={style.voucher_list}>\n            {counts.map((i) => (\n                <div key={i} className={style.load_item_cnt}>\n                    <div className={style.load_item_left}>\n                        <Skeleton width={\"100%\"} height={\"100%\"} />\n                    </div>\n                    <div className={style.load_item_right}>\n                        <div className={style.load_item_right_item}>\n                            <Skeleton width={\"100%\"} height={\"100%\"} />\n                        </div>\n                        <div className={style.load_item_right_item}>\n                            <Skeleton width={\"100%\"} height={\"100%\"} />\n                        </div>\n                    </div>\n                </div>\n            ))}\n        </div>\n    );\n};\n"],"names":["VoucherPage","IS_MB","useDeviceMobile","PLAT_FORM","EXTRA_FLAT_FORM","newParams","paramsDiscounts","limit","sort","resData","totalItem","onLoadMore","useSwrInfinite","discounts","discountItems","map","i","items","child","discount","flat","_jsxs","children","_jsx","HeadMobile","title","Container","className","style","InfiniteScroll","dataLength","length","hasMore","loader","_Fragment","next","onViewMore","item","index","ItemDiscount","LoadSkelton","_ref","_item$productable","_item$productable2","_item$organization","_item$productable3","_item$productable4","_item$productable5","_item$productable6","_item$discount","_item$discount2","_item$discount3","_item$discount4","_item$discount5","_item$discount6","history","useHistory","src","productable","image","image_url","organization","alt","service_name","product_name","formatPrice","price","retail_price","discount_type","DISCOUNT_TYPE","discount_value","view_price","valid_from","dayjs","format","valid_util","XButton","onClick","onDetail","tracking","id","discount_id","logEvent","analytics","service","merchant","name","push","formatRouterLinkDiscount","Skeleton","width","height"],"sourceRoot":""}